(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{20011:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155),s=r(58607);let o=e=>{let{isOpen:t,onClose:r,onConfirm:o,title:l,message:n,isLoading:i=!1}=e;return(0,a.jsx)(s.A,{isOpen:t,onClose:r,title:l,size:"md",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4 dark:text-white",children:n}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:r,className:"disabled:opacity-50 px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 dark:bg-gray-800 dark:text-white",disabled:i,children:"Cancel"}),(0,a.jsx)("button",{onClick:o,className:"disabled:opacity-50 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-600 dark:text-white",disabled:i,children:"Confirm"})]})]})})}},27203:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155),s=r(12115);function o(e){var t;let r=(0,s.useRef)(null);return t=e.onClick,(0,s.useEffect)(()=>{function e(e){r.current&&!r.current.contains(e.target)&&(e.stopPropagation(),t())}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t,r]),(0,a.jsx)("div",{className:e.className,ref:r,children:e.children})}},30851:(e,t,r)=>{"use strict";r.d(t,{A:()=>a.default});var a=r(43166)},43166:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var a=r(95155),s=r(35695),o=r(12115),l=r(75010),n=r(70241);let i=e=>{let{initialQuery:t,placeholder:r}=e,i=(0,s.useRouter)(),[c,d]=(0,o.useState)(t),u=(0,l.sg)(e=>{let t=new URLSearchParams;e&&t.set("searchString",e),i.push("?".concat(t.toString()))},400);return(0,a.jsx)(n.A,{value:c||"",onChange:e=>{d(e),u(e)},placeholder:r})}},58296:(e,t,r)=>{"use strict";r.d(t,{default:()=>L});var a=r(95155),s=r(12115),o=r(35695),l=r(38543),n=r(89917),i=r(62525),c=r(4229),d=r(84616),u=r(17707),m=r(74157),g=r(30851),h=r(20011),x=r(34477);let f=(0,x.createServerReference)("40e912ef972733e1d060e33984c9292b23feae5b9d",x.callServer,void 0,x.findSourceMapURL,"getChatRoomsList"),p=(0,x.createServerReference)("4098087955e05a9441fad4db7a6d0c30b05459d339",x.callServer,void 0,x.findSourceMapURL,"deleteChatRooms");var y=function(e){return e.CREATE="create",e.EDIT="edit",e.DELETE="delete",e}({}),b=r(60556),v=r(58607);let R=(0,x.createServerReference)("40fcddc420d4fecc89c08cdafa5e8c7f7b7c7747ef",x.callServer,void 0,x.findSourceMapURL,"updateChatRoom"),E=(0,x.createServerReference)("40910088eb5a0eb78ba4b73dba14af29323ecdc336",x.callServer,void 0,x.findSourceMapURL,"createChatRoom");var j=r(80265),O=r(4924);let S=e=>{let{isOpen:t,onClose:r,onSuccess:n,room:i,isEdit:c=!1}=e,d=(0,o.useRouter)(),[u,m]=(0,s.useState)(!1),[g,h]=(0,s.useState)({name:"",logoURL:""});(0,s.useEffect)(()=>{c&&i?h({name:i.name||"",logoURL:i.logoURL||""}):h({name:"",logoURL:""})},[c,i,t]);let x=async e=>{if(e.preventDefault(),!g.name.trim())return void l.oR.error("Room name is required");if(!g.logoURL.trim())return void l.oR.error("Room logo is required");m(!0);try{let e;(e=c&&i?await R({chatRoomId:i._id,name:g.name.trim(),logoURL:g.logoURL.trim()}):await E({name:g.name.trim(),logoURL:g.logoURL.trim()})).status?(l.oR.success(e.message||(c?"Chat room updated successfully":"Chat room created successfully")),null==n||n(),r(),d.refresh()):l.oR.error(e.message||"Operation failed")}catch(e){l.oR.error("An error occurred")}finally{m(!1)}};return(0,a.jsx)(v.A,{isOpen:t,onClose:r,title:c?b.Q.EDIT_ROOM:b.Q.CREATE_ROOM,size:"md",children:(0,a.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[b.Q.ROOM_NAME," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:g.name,onChange:e=>{let{name:t,value:r}=e.target;h(e=>({...e,[t]:r}))},placeholder:b.Q.ENTER_ROOM_NAME,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-600 dark:text-white",required:!0})]}),(0,a.jsx)("div",{children:(0,a.jsx)(O.B,{label:b.Q.ROOM_LOGO,value:g.logoURL,onChange:e=>{let t=e;if(e&&!e.startsWith("http")&&!e.startsWith("blob:")){let r="https://raypto-prod.onrender.com".replace(/\/$/,"")||"";t="".concat(r,"/").concat(e)}h(e=>({...e,logoURL:t}))},required:!0,uploadFunction:j.u,fileType:O.e.ROOM_LOGO,aspectRatio:"16/9",placeholder:"Click or drag to upload room logo",maxSize:2})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:u,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#4F46E5] text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",disabled:u,children:u?"Saving...":c?"Update":"Create"})]})]})})};var N=r(75010),w=r(92502),k=r(80292),C=r(4460),A=r(56164);let L=e=>{var t,r;let{chatRoomsData:x,searchString:v,initialTranslationConfig:R}=e,E=(0,o.useRouter)(),j=(0,o.useSearchParams)(),[O,L]=(0,s.useState)(""),[T,M]=(0,s.useState)(1),[_,U]=(0,s.useState)(10),[D,I]=(0,s.useState)(1),[F,P]=(0,s.useState)(!1),[Q,G]=(0,s.useState)(!1),[z,H]=(0,s.useState)((null==R?void 0:R.enableChatTranslation)||!1),[q,K]=(0,s.useState)((null==R?void 0:R.chatTranslationLanguage)||w.GP.ENGLISH),[$,B]=(0,s.useState)(x);(0,s.useEffect)(()=>{B(x)},[x]);let J=async()=>{P(!0);try{let e=await f({searchString:v,skip:(D-1)*_,limit:_,sortKey:O,sortDirection:T});e.status&&B(e)}catch(e){console.error("Error fetching chat rooms:",e)}finally{P(!1)}},[W,Y]=(0,s.useState)({open:!1}),[V,X]=(0,s.useState)({open:!1}),Z=[{field:"_id",title:"ID",render:e=>(null==e?void 0:e._id)?"#".concat(e._id.slice(-6)):""},{field:"name",title:"Name",render:e=>{var t;return(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:null!=(t=null==e?void 0:e.name)?t:""})},sortable:!0,sortKey:"name"},{field:"logoURL",title:"Logo",render:e=>(null==e?void 0:e.logoURL)&&(e=>{try{return new URL(e),!0}catch(e){return!1}})(e.logoURL)?(0,a.jsx)("div",{className:"w-10 h-10 relative rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800",children:(0,a.jsx)("img",{src:e.logoURL,alt:e.name||"Room logo",className:"w-full h-full object-cover",onError:e=>{let t=e.target;t.style.display="none",t.parentElement.innerHTML='<span class="text-gray-400 text-[0.875] flex items-center justify-center w-full h-full">—</span>'}})}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400 text-[0.875]",children:"—"})})},{field:"createdAt",title:"Created At",render:e=>(null==e?void 0:e.createdAt)?(0,N.Yq)(new Date(e.createdAt)):"—",sortable:!0,sortKey:"createdAt"},{field:"",title:"Actions",render:e=>(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>Y({open:!0,type:y.EDIT,room:e}),className:"text-gray-500 hover:text-blue-600 transition-colors",title:"Edit",children:(0,a.jsx)(n.A,{size:18})}),(0,a.jsx)("button",{onClick:()=>X({open:!0,roomId:e._id}),className:"text-gray-500 hover:text-red-600 transition-colors",title:"Delete",children:(0,a.jsx)(i.A,{size:18})})]})}],ee=async()=>{if(V.roomId){P(!0);try{let e=await p({chatRoomIds:[V.roomId]});e.status?(l.oR.success(e.message||"Chat room deleted successfully"),J(),E.refresh()):l.oR.error(e.message||"Failed to delete chat room")}catch(e){l.oR.error("An error occurred while deleting the chat room")}finally{P(!1),X({open:!1})}}},et=async()=>{G(!0);try{let e=await (0,k.O)({type:w.Om.CHAT_TRANSLATION,enableChatTranslation:z,...z&&{chatTranslationLanguage:q}});e.status?(l.oR.success(e.message||"Translation settings updated"),J(),E.refresh()):l.oR.error(e.message||"Failed to update settings")}catch(e){l.oR.error("An error occurred while saving settings")}finally{G(!1)}};return(0,s.useEffect)(()=>{let e=new URLSearchParams(j.toString());D>1?e.set("skip",((D-1)*_).toString()):e.delete("skip"),10!==_?e.set("limit",_.toString()):e.delete("limit"),O?(e.set("sortKey",O),e.set("sortDirection",T.toString())):(e.delete("sortKey"),e.delete("sortDirection")),E.push("?".concat(e.toString()))},[D,_,O,T,j,E]),(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-gray-900 rounded-[24px] shadow-sm",children:[(0,a.jsx)("div",{className:"px-6 py-2 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[(0,a.jsx)("h2",{className:"text-[1.5rem] font-bold text-[#1B2559] dark:text-white",children:b.Q.CHAT_ROOMS}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsx)(g.A,{initialQuery:v,placeholder:b.Q.SEARCH_ROOMS}),(0,a.jsxs)("div",{className:"flex items-center gap-4 bg-gray-50 dark:bg-gray-800/50 p-2 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Translation:"}),(0,a.jsx)(C.A,{enabled:z,onToggle:()=>H(!z)})]}),z&&(0,a.jsx)("div",{className:"w-40",children:(0,a.jsx)(A.A,{options:w.nk,value:w.nk.find(e=>e.value===q),onChange:e=>K((null==e?void 0:e.value)||w.GP.ENGLISH),placeholder:"Language",className:"text-sm"})}),(0,a.jsx)("button",{onClick:et,disabled:Q,className:"p-2 bg-[#4F46E5] text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",title:"Save Translation Settings",children:Q?(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}):(0,a.jsx)(c.A,{size:18})})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 bg-[#4F46E5] text-white rounded-lg hover:bg-purple-700 transition-colors",onClick:()=>Y({open:!0,type:y.CREATE}),children:[(0,a.jsx)(d.A,{size:18}),(0,a.jsx)("span",{children:b.Q.CREATE_ROOM})]})]})]})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsx)(u.A,{data:(null==$||null==(t=$.data)?void 0:t.data)||[],columns:Z,keyExtractor:e=>e._id||"",handleSort:(e,t)=>{L(e),M(t)},hideSelectCol:!0,emptyMessage:b.Q.NO_ROOMS})}),(0,a.jsx)("div",{className:"mt-auto flex-shrink-0",children:(0,a.jsx)(m.A,{totalItems:(null==$||null==(r=$.data)?void 0:r.count)||0,currentPage:D,pageSize:_,onPageChange:e=>I(e+1),onPageSizeChange:e=>{U(e),I(1)},title:"Chat Rooms"})})]}),(0,a.jsx)(S,{isOpen:W.open&&(W.type===y.CREATE||W.type===y.EDIT),onClose:()=>Y({open:!1}),onSuccess:J,room:W.room,isEdit:W.type===y.EDIT}),(0,a.jsx)(h.A,{isOpen:V.open,onClose:()=>X({open:!1}),onConfirm:()=>void ee(),title:b.Q.DELETE_ROOM,message:b.Q.DELETE_ROOM_CONFIRMATION,isLoading:F})]})}},58607:(e,t,r)=>{"use strict";r.d(t,{A:()=>a.A});var a=r(59927)},59649:(e,t,r)=>{Promise.resolve().then(r.bind(r,58296))},59927:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(95155),s=r(52596),o=r(12115),l=r(27203);let n={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl"},i=e=>{let{isOpen:t,onClose:r,title:i,children:c,className:d="",size:u="lg"}=e;return((0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r()};return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-white/10 backdrop-blur-sm dark:bg-gray-900/50",children:(0,a.jsx)(l.A,{onClick:r,className:(0,s.A)("w-full",n[u],d),children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 relative dark:bg-gray-900 dark:border-gray-800 ".concat(d),role:"dialog","aria-modal":"true",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-lg dark:text-white","aria-label":"Close",children:"✕"}),i&&(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:i}),c]})})}):null}},60556:(e,t,r)=>{"use strict";r.d(t,{Q:()=>a});let a={CHAT_ROOMS:"Chat Rooms",CREATE_ROOM:"Create Room",EDIT_ROOM:"Edit Room",DELETE_ROOM:"Delete Room",ROOM_NAME:"Room Name",ROOM_LOGO:"Room Logo URL",MESSAGES:"Messages",NO_ROOMS:"No chat rooms available",NO_MESSAGES:"No messages in this chat room",DELETE_ROOM_CONFIRMATION:"Are you sure you want to delete this chat room?",DELETE_MESSAGE_CONFIRMATION:"Are you sure you want to delete this message?",SEARCH_ROOMS:"Search rooms...",ENTER_ROOM_NAME:"Enter room name",ENTER_LOGO_URL:"Enter logo URL",ROOMS:"Rooms",LIVE_CHAT:"Live Chat"}},70241:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155),s=r(47924);let o=e=>{let{value:t,onChange:r,placeholder:o="Search...",className:l=""}=e;return(0,a.jsxs)("div",{className:"relative rounded-[8px] ".concat(l),children:[(0,a.jsx)(s.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-[#1b2559] dark:text-gray-400",size:18}),(0,a.jsx)("input",{type:"text",placeholder:o,value:t,onChange:e=>r(e.target.value),className:"pr-10 pl-4 py-2 border border-[#f4f7fe] rounded-lg w-full dark:bg-gray-900 dark:border-gray-800 dark:text-white"})]})}},75010:(e,t,r)=>{"use strict";r.d(t,{B8:()=>h,JK:()=>y,Jr:()=>E,M$:()=>c,Uk:()=>v,Vt:()=>x,Yq:()=>f,cn:()=>u,cu:()=>p,jd:()=>g,qY:()=>b,sg:()=>m,vv:()=>R,x4:()=>d});var a=r(52596),s=r(16694),o=r(78192),l=r.n(o),n=r(39688),i=r(92502);async function c(e){try{let t=await fetch("/api/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok){let e=await t.json();return console.error("Failed to create session:",e),!1}return!0}catch(e){return console.error("❌ Error in createSessionClient:",e),!1}}async function d(){try{let e=await fetch("/api/session",{method:"DELETE"});if(!e.ok){let t=await e.json();return console.error("Failed to delete session:",t),!1}return!0}catch(e){return console.error("❌ Error in deleteSessionClient:",e),!1}}function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.A)(t))}function m(e,t){let r;return function(){for(var a=arguments.length,s=Array(a),o=0;o<a;o++)s[o]=arguments[o];clearTimeout(r),r=setTimeout(()=>{e(...s)},t)}}let g=e=>e.replace(/\D/g,"").replace(/(.{4})/g,"$1 ").trim(),h=e=>{let t=e.replace(/\D/g,"").slice(0,4);return t.length<=2?t:"".concat(t.slice(0,2),"/").concat(t.slice(2))},x=(e,t)=>{let r=e.replace(/\D/g,""),a=l().fns.cardType(t);return r.slice(0,"amex"===a?4:3)},f=e=>e?(0,s.GP)(e,"MMM d, yyyy h:mm a"):"";async function p(e){try{let t=await fetch("/api/locale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locale:e})});if(!t.ok){let e=await t.json();return console.error("Failed to update locale:",e),!1}return!0}catch(e){return console.error("❌ Error in updateLocale:",e),!1}}async function y(){try{let e=await fetch("/api/locale",{method:"GET"});if(!e.ok){let t=await e.json();return console.error("Failed to get locale:",t),null}let t=await e.json();return console.log(t,"res in getLocale"),t.locale||"en"}catch(e){return console.error("❌ Error in getLocale:",e),null}}let b=e=>i.WN[e]||"bg-gray-100 text-gray-800",v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return e?e.length<=t+r?e:"".concat(e.slice(0,t),"...").concat(e.slice(-r)):""},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e)return"0";let a=Math.abs(e),s="";for(let{threshold:e,suffix:r}of[{threshold:1e12,suffix:"T"},{threshold:1e9,suffix:"B"},{threshold:1e6,suffix:"M"},{threshold:1e3,suffix:"K"}])if(a>=e){s=(a/e).toFixed(t).replace(/\.?0+$/,"")+r;break}return(s||(s=a.toFixed(t).replace(/\.?0+$/,"")),e<0)?"-".concat(s):r&&e>0?"+".concat(s):s},E=(e,t,r,a)=>({field:e,title:t,render:r,sortable:!0,sortKey:a||e})},80292:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});var a=r(34477);let s=(0,a.createServerReference)("40b8b386dbad7eda36cbd05a9515afd6de4a5af42e",a.callServer,void 0,a.findSourceMapURL,"updateConfigAction")}},e=>{var t=t=>e(e.s=t);e.O(0,[8543,5520,8291,9299,3063,648,2502,5991,5748,8441,1684,7358],()=>t(59649)),_N_E=e.O()}]);