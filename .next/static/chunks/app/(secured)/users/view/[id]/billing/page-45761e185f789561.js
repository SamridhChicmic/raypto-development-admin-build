(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9898],{20011:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95155),s=r(58607);let n=e=>{let{isOpen:t,onClose:r,onConfirm:n,title:l,message:i,isLoading:o=!1}=e;return(0,a.jsx)(s.A,{isOpen:t,onClose:r,title:l,size:"md",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4 dark:text-white",children:i}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:r,className:"disabled:opacity-50 px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 dark:bg-gray-800 dark:text-white",disabled:o,children:"Cancel"}),(0,a.jsx)("button",{onClick:n,className:"disabled:opacity-50 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-600 dark:text-white",disabled:o,children:"Confirm"})]})]})})}},45585:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var a=r(95155),s=r(35695),n=r(12115),l=r(38543),i=r(34477);let o=(0,i.createServerReference)("4079aa22cfc26539f9588adb0af93f58b7de383444",i.callServer,void 0,i.findSourceMapURL,"deletePaymentMethod"),c=(0,i.createServerReference)("407bda9c50640a70dc1b43aa9b3bee005ca94442d4",i.callServer,void 0,i.findSourceMapURL,"addPaymentMethod");var d=r(97712),u=r(20011),x=r(58607),m=r(59274),h=r(75010),g=function(e){return e[e.ADD=0]="ADD",e[e.EDIT=1]="EDIT",e}(g||{});function p(e){let{cards:t,id:r}=e,[i,g]=(0,n.useTransition)(),p=(0,s.useRouter)(),[y,f]=(0,n.useState)({open:!1}),[b,v]=(0,n.useState)({open:!1});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6  space-y-6 dark:bg-gray-900 dark:border-gray-800 dark:text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Payment Methods"}),(0,a.jsx)(d.A,{onClick:()=>f({open:!0,type:0}),children:"+ Add Card"})]}),(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between border rounded px-4 py-3",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:e.cardHolderName})}),(0,a.jsxs)("p",{className:"text-gray-600 text-sm tracking-widest dark:text-white",children:["**** **** **** ",e.cardNumberLast4Digits]})]})}),(0,a.jsxs)("div",{className:"text-right space-y-1",children:[(0,a.jsx)("div",{className:"flex gap-2 justify-end",children:(0,a.jsx)("button",{onClick:()=>v({open:!0,id:e._id}),className:"text-[0.875] bg-red-100 text-red-600 px-3 py-1 rounded",children:"Delete"})}),(0,a.jsxs)("p",{className:"text-[0.875rem] text-[#A3AED0] dark:text-white",children:["Card expires at ",Number(e.cardExpiryMonth)+1,"/",Number(e.cardExpiryYear)-2e3]})]})]},e._id))})]}),(0,a.jsxs)(x.A,{isOpen:y.open,onClose:()=>f({open:!1}),children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-white",children:"Add new card to complete payment"})]}),(0,a.jsx)(m.A,{onSubmit:e=>{g(async()=>{var t,a,s,n,i;let o=await c({cardNumber:null==(s=e.cardNumber)||null==(a=s.trim())||null==(t=a.split(" "))?void 0:t.join(""),cardHolderName:e.cardHolderName,cardExpiryMonth:Number(null==(n=e.cardExpiry)?void 0:n.split("/")[0])-1,cardExpiryYear:2e3+Number(null==(i=e.cardExpiry)?void 0:i.split("/")[1]),cvv:e.cvv,userId:r});o.status?(l.oR.success(o.message),f({open:!1}),p.refresh()):l.oR.error(o.message)})},formConfig:e=>{let{watch:t}=e;return[{label:"Card Number",type:"text",name:"cardNumber",interceptor:e=>(0,h.jd)(e)},{label:"Name",type:"text",name:"cardHolderName"},{label:"Exp. Date",type:"text",name:"cardExpiry",interceptor:e=>(0,h.B8)(e)},{label:"CVV Code",type:"text",name:"cvv",interceptor:e=>(0,h.Vt)(e,t("cardNumber")||"")}]},scrollable:!0,isLoading:i})]}),(0,a.jsx)(u.A,{isOpen:b.open,onClose:()=>v({open:!1}),onConfirm:()=>{g(async()=>{let e=await o({paymentMethodIds:[b.id||""],userId:r});console.log(e),e.status?(l.oR.success(e.message),v({open:!1}),p.refresh()):l.oR.error(e.message)})},title:"Delete Card",message:"Are you sure you want to delete this card?"})]})}},58607:(e,t,r)=>{"use strict";r.d(t,{A:()=>a.A});var a=r(59927)},59927:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155),s=r(52596),n=r(12115),l=r(27203);let i={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl"},o=e=>{let{isOpen:t,onClose:r,title:o,children:c,className:d="",size:u="lg"}=e;return((0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r()};return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-white/10 backdrop-blur-sm dark:bg-gray-900/50",children:(0,a.jsx)(l.A,{onClick:r,className:(0,s.A)("w-full",i[u],d),children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 relative dark:bg-gray-900 dark:border-gray-800 ".concat(d),role:"dialog","aria-modal":"true",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-lg dark:text-white","aria-label":"Close",children:"✕"}),o&&(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:o}),c]})})}):null}},75010:(e,t,r)=>{"use strict";r.d(t,{B8:()=>h,JK:()=>f,Jr:()=>j,M$:()=>c,Uk:()=>v,Vt:()=>g,Yq:()=>p,cn:()=>u,cu:()=>y,jd:()=>m,qY:()=>b,sg:()=>x,vv:()=>w,x4:()=>d});var a=r(52596),s=r(16694),n=r(78192),l=r.n(n),i=r(39688),o=r(92502);async function c(e){try{let t=await fetch("/api/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok){let e=await t.json();return console.error("Failed to create session:",e),!1}return!0}catch(e){return console.error("❌ Error in createSessionClient:",e),!1}}async function d(){try{let e=await fetch("/api/session",{method:"DELETE"});if(!e.ok){let t=await e.json();return console.error("Failed to delete session:",t),!1}return!0}catch(e){return console.error("❌ Error in deleteSessionClient:",e),!1}}function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.A)(t))}function x(e,t){let r;return function(){for(var a=arguments.length,s=Array(a),n=0;n<a;n++)s[n]=arguments[n];clearTimeout(r),r=setTimeout(()=>{e(...s)},t)}}let m=e=>e.replace(/\D/g,"").replace(/(.{4})/g,"$1 ").trim(),h=e=>{let t=e.replace(/\D/g,"").slice(0,4);return t.length<=2?t:"".concat(t.slice(0,2),"/").concat(t.slice(2))},g=(e,t)=>{let r=e.replace(/\D/g,""),a=l().fns.cardType(t);return r.slice(0,"amex"===a?4:3)},p=e=>e?(0,s.GP)(e,"MMM d, yyyy h:mm a"):"";async function y(e){try{let t=await fetch("/api/locale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locale:e})});if(!t.ok){let e=await t.json();return console.error("Failed to update locale:",e),!1}return!0}catch(e){return console.error("❌ Error in updateLocale:",e),!1}}async function f(){try{let e=await fetch("/api/locale",{method:"GET"});if(!e.ok){let t=await e.json();return console.error("Failed to get locale:",t),null}let t=await e.json();return console.log(t,"res in getLocale"),t.locale||"en"}catch(e){return console.error("❌ Error in getLocale:",e),null}}let b=e=>o.WN[e]||"bg-gray-100 text-gray-800",v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return e?e.length<=t+r?e:"".concat(e.slice(0,t),"...").concat(e.slice(-r)):""},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e)return"0";let a=Math.abs(e),s="";for(let{threshold:e,suffix:r}of[{threshold:1e12,suffix:"T"},{threshold:1e9,suffix:"B"},{threshold:1e6,suffix:"M"},{threshold:1e3,suffix:"K"}])if(a>=e){s=(a/e).toFixed(t).replace(/\.?0+$/,"")+r;break}return(s||(s=a.toFixed(t).replace(/\.?0+$/,"")),e<0)?"-".concat(s):r&&e>0?"+".concat(s):s},j=(e,t,r,a)=>({field:e,title:t,render:r,sortable:!0,sortKey:a||e})},80251:(e,t,r)=>{Promise.resolve().then(r.bind(r,45585))},97712:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(95155);r(12115);let s=e=>{let{variant:t="primary",size:r="md",leftIcon:s,rightIcon:n,isLoading:l=!1,fullWidth:i=!1,children:o,className:c="",disabled:d,...u}=e,x=d||l?"opacity-60 cursor-not-allowed":"";return(0,a.jsxs)("button",{className:"\n        ".concat("inline-flex items-center justify-center font-medium transition-colors rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer","\n        ").concat({primary:"bg-[#4F46E5] text-white hover:bg-purple-700 focus:ring-purple-500",secondary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-purple-500",ghost:"text-gray-700 bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500"}[t],"\n        ").concat({sm:"text-sm px-3 py-1.5",md:"text-base px-4 py-2",lg:"text-lg px-6 py-3",icon:"p-2"}[r],"\n        ").concat(x,"\n        ").concat(i?"w-full":"","\n        ").concat(c,"\n      "),disabled:d||l,...u,children:[l&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!l&&s&&(0,a.jsx)("span",{className:"mr-2",children:s}),o,!l&&n&&(0,a.jsx)("span",{className:"ml-2",children:n})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1129,8543,5520,8291,9299,357,8735,2502,9274,8441,1684,7358],()=>t(80251)),_N_E=e.O()}]);